{% extends 'book/base.html' %}

{% block title %}{{ title }}Dashboard - Book Display{% endblock %}

{% block content }

<div class="row mb-4">
    <div class="col-12">
        <h1>Dashboard</h1>
        <p class="text-muted">Welcome to the Books Display platform</p>
    </div>
</div>

<!-- display stats here -->
 <!-- STATISTICS SECTION - Shows important numbers -->
<div class="row mb-4">
    <!-- Total Books stat -->
    <div class="col-md-3 col-sm-6 mb-3">
        <div class="p-3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px;">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <div style="font-size: 2.5rem; font-weight: bold;">{{ total_books }}</div>
                    <div>Total Books</div>
                </div>
                <i class="bi bi-book" style="font-size: 3rem; opacity: 0.5;"></i>
            </div>
        </div>
    </div>

    <!-- Available Books stat -->
    <div class="col-md-3 col-sm-6 mb-3">
        <div class="p-3" style="background: linear-gradient(135deg, #0ba360 0%, #3cba92 100%); color: white; border-radius: 10px;">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <div style="font-size: 2.5rem; font-weight: bold;">{{ available_books }}</div>
                    <div>Available</div>
                </div>
                <i class="bi bi-check-circle" style="font-size: 3rem; opacity: 0.5;"></i>
            </div>
        </div>
    </div>

    <!-- Borrowed Books stat -->
    <div class="col-md-3 col-sm-6 mb-3">
        <div class="p-3" style="background: linear-gradient(135deg, #f2994a 0%, #f2c94c 100%); color: white; border-radius: 10px;">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <div style="font-size: 2.5rem; font-weight: bold;">{{ borrowed_books }}</div>
                    <div>Borrowed</div>
                </div>
                <i class="bi bi-arrow-right-circle" style="font-size: 3rem; opacity: 0.5;"></i>
            </div>
        </div>
    </div>

    <!-- Total Authors stat -->
    <div class="col-md-3 col-sm-6 mb-3">
        <div class="p-3" style="background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%); color: white; border-radius: 10px;">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <div style="font-size: 2.5rem; font-weight: bold;">{{ total_authors }}</div>
                    <div>Authors</div>
                </div>
                <i class="bi bi-people" style="font-size: 3rem; opacity: 0.5;"></i>
            </div>
        </div>
    </div>
</div>

<!-- QUICK ACTIONS SECTION -->
<div class="row mb-4">
    <div class="col-12">
        <h3 class="mb-3">Quick Actions</h3>
    </div>
    
    <!-- Browse Books button -->
    <div class="col-md-3 mb-3">
        <a href="{% url 'book:book_list' %}" class="btn btn-primary w-100 p-3">
            <i class="bi bi-book"></i> Browse Books
        </a>
    </div>

    <!-- Add Book button -->
    <div class="col-md-3 mb-3">
        <a href="{% url 'book:book_create' %}" class="btn btn-success w-100 p-3">
            <i class="bi bi-plus-circle"></i> Add New Book
        </a>
    </div>

    <!-- Borrow a Book button -->
    <div class="col-md-3 mb-3">
        <a href="{% url 'book:borrow_list' %}" class="btn btn-info w-100 p-3">
            <i class="bi bi-arrow-right-circle"></i> Borrow Book
        </a>
    </div>

    <!-- Return a Book button -->
    <div class="col-md-3 mb-3">
        <a href="{% url 'book:return_list' %}" class="btn btn-warning w-100 p-3">
            <i class="bi bi-arrow-left-circle"></i> Return Book
        </a>
    </div>
</div>

<!-- TWO COLUMN LAYOUT -->
<div class="row">
    <!-- LEFT COLUMN - Recent Activity -->
    <div class="col-md-8">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title mb-4">Recent Activity</h4>
                
                <!-- Activity list -->
                <div class="list-group list-group-flush">
                    {% for record in recent_activity %}
                    <div class="list-group-item">
                        <div class="d-flex w-100 justify-content-between">
                            <h6 class="mb-1">
                                {% if record.is_returned %}
                                    <i class="bi bi-arrow-left-circle text-success"></i> Book Returned
                                {% else %}
                                    <i class="bi bi-arrow-right-circle text-warning"></i> Book Borrowed
                                {% endif %}
                            </h6>
                            <small>{{ record.borrow_date|timesince }} ago</small>
                        </div>
                        <p class="mb-1">
                            "{{ record.book.title }}" 
                            {% if record.is_returned %}
                                returned by {{ record.borrower.username }}
                            {% else %}
                                borrowed by {{ record.borrower.username }}
                            {% endif %}
                        </p>
                    </div>
                    {% empty %}
                    <p class="text-muted">No recent activity</p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <!-- RIGHT COLUMN - Overdue Books -->
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title text-danger">
                    <i class="bi bi-exclamation-triangle"></i> Overdue Books
                </h5>
                <hr>
                
                {% if overdue_books %}
                <div class="list-group list-group-flush">
                    {% for record in overdue_books %}
                    <div class="list-group-item px-0">
                        <h6 class="mb-1">{{ record.book.title }}</h6>
                        <small>
                            Borrower: {{ record.borrower.username }}<br>
                            Due: {{ record.due_date|date:"M d, Y" }}
                        </small>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-muted">No overdue books!</p>
                {% endif %}
            </div>
        </div>

        <!-- Categories Quick View -->
        <div class="card mt-3">
            <div class="card-body">
                <h5 class="card-title">Categories</h5>
                <hr>
                <ul class="list-unstyled">
                    {% for category in categories %}
                    <li class="mb-2">
                        <a href="{% url 'book:book_list' %}?category={{ category.pk }}" class="text-decoration-none">
                            <i class="bi bi-folder"></i> {{ category.name }}
                            <span class="badge bg-secondary">{{ category.books.count }}</span>
                        </a>
                    </li>
                    {% empty %}
                    <li class="text-muted">No categories yet</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>

{% endblock %}





